<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ncst.hospitaloutpatient.mapper.organization.DoctorMapper">

    <select id="selectDoctorsByDepartmentId" resultType="com.ncst.hospitaloutpatient.model.dto.organization.DoctorResponse">
        SELECT
            s.staff_id AS staffId,
            s.name,
            s.phone,
            s.id_card AS idCard,
            s.department_id AS departmentId,
            s.description,
            s.role_id AS roleId,
            s.create_time AS createTime,
            IFNULL(ext.is_expert, 0) AS isExpert
        FROM staff s
                 INNER JOIN staff_role r ON s.role_id = r.role_id
                 LEFT JOIN staff_doctor_ext ext ON s.staff_id = ext.staff_id
        WHERE s.department_id = #{departmentId}
          AND r.role_name = 'doctor'
    </select>

</mapper>